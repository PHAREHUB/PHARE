

# Having Issues

Please run:

> ./tools/report.sh # or "python3 tools/report.py" with the correct PYTHONPATH

This will build a zip archive "REPORT_INFO.zip", which you should either email to us, or
Log an issue on github via https://github.com/PHAREHUB/PHARE/issues/new
Outline the context of your issue, and upload the zip




# Known Issues

1. OMPI symbol resolution with python3.
    Affects: OMPI versions < 3
    Source: https://github.com/open-mpi/ompi/issues/3705
    Solution:
      import ctypes
      ctypes.CDLL("libmpi.so", mode=ctypes.RTLD_GLOBAL)

2. Python launching, with C++ MPI init, doesn't work so well with MPI4PY
    Source: https://bitbucket.org/mpi4py/mpi4py/issues/154/attempting-to-use-an-mpi-routine-before
    Solution:
      LD_PRELOAD=/path/to/your/libmpi.so python3 $SCRIPT

3. SAMRAI Static Library Incompatibility

   PROBLEM:
     SAMRAI libraries used by PHARE Python modules MUST be shared libraries (.so/.dylib),
     not static archives (.a). 
     
   WHY:
     SAMRAI contains static singletons (e.g., VariableDatabase, RestartManager).
     When SAMRAI is statically linked, each Python module (cpp_1_2_3, cpp_1_2_4, etc.)
     gets its own copy of these singletons, causing crashes and data corruption.
     
   SOLUTION:
     By default, PHARE builds SAMRAI with shared libraries (-DSAMRAI_BUILD_SHARED_LIBS=ON).
     To use a pre-installed SAMRAI, it MUST be built with shared libraries:
       cmake -DSAMRAI_ROOT=/path/to/samrai -DSAMRAI_BUILD_SHARED_LIBS=ON
       
   SYMPTOMS:
     - Segmentation faults when switching between different simulator configurations
     - "Variable already registered" errors from SAMRAI
     - Crashes in SAMRAI's VariableDatabase or RestartManager
     
   VERIFICATION:
     Check if SAMRAI is shared:
       file /path/to/samrai/lib/libSAMRAI_*.so  # should show "shared object"
       # NOT "ar archive"
