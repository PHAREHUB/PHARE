#!/usr/bin/env python

import os
import subprocess
import sys


cmake_build_dir = "@CMAKE_BINARY_DIR@"
cmake_source_dir = "@CMAKE_SOURCE_DIR@"
pharein_dir      = os.path.join(cmake_source_dir, "subprojects")
venv_path = os.environ.get('VIRTUAL_ENV')

if venv_path is not None:
    pythonexe = os.path.join(venv_path, "bin/python")
    arg = "import sys; print(sys.path)"
    p = subprocess.run([pythonexe, "-c", arg], stdout=subprocess.PIPE)
    s = p.stdout.decode()
    s = s.replace('[','').replace(']','').replace('"',"").replace("\n","").replace("'",'')
    s = s.split(",")[1:]
    pythonpath = [ss.strip() for ss in s]
    sys.path = sys.path + pythonpath +  [cmake_source_dir, cmake_build_dir]

else:
    sys.path  = sys.path + [cmake_source_dir, cmake_build_dir, pharein_dir]



